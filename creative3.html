<html>
<head>
<link rel='stylesheet' type='text/css' href='section2.css'/>
<title>City Finder</title>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script>
$(document).ready(function() {
	$( "#cityfield" ).keyup(function() {
		var url = "http://bioresearch.byu.edu/cs260/jquery/getcity.cgi?q="+$("#cityfield").val();
		$.getJSON(url,function(data) {
			var everything;
			everything = "<ul>";
  			$.each(data, function(i,item) {
    				everything += "<li> "+data[i].city;
  			});
			everything += "</ul>";
  			$("#txtHint").html(everything);
  		})
	})
	$("#button").click(function(e){
		var value = $("#cityfield").val();
		console.log(value);
		e.preventDefault();
		$("#dispcity").text(value);
		var myurl= "https://api.wunderground.com/api/b929e245f7df1bd6/geolookup/conditions/q/UT/";
		myurl += value;
		myurl += ".json";
		console.log(myurl);
		$.ajax({
			url : myurl,
			dataType : "jsonp",
			success : function(parsed_json) {
				var location = parsed_json['location']['city'];
				var temp_string = parsed_json['current_observation']['temperature_string'];
				var current_weather = parsed_json['current_observation']['weather'];
				everything = "<ul>";
				everything += "<li>Location: "+location;
				everything += "<li>Temperature: "+temp_string;
				everything += "<li>Weather: "+current_weather;
				everything += "</ul>";
				$("#weather").html(everything);
			}
		})

	})
	$("#button2").click(function(e){
		var value2 = $("#question").val();
		console.log(value2);
		e.preventDefault();
		var myurl2= "https://api.stackexchange.com/2.2/search?order=desc&sort=activity&intitle=";
		myurl2 += value2;
		myurl2 += "&site=stackoverflow";
		$.ajax({
			url : myurl2,
			datatype : "jsonp",
			success : function(data) {
				var something = "Top 3 Results:<br>";
				var number1 = data['items']['0']['title'];
				var link1 = data['items']['0']['link'];
				var number2 = data['items']['1']['title'];
				var link2 = data['items']['1']['link'];
				var number3 = data['items']['2']['title'];
				var link3 = data['items']['2']['link'];
				something += "<a href=\"" + link1 + "\">" + number1 + "</a><br>";
				something += "<a href=\"" + link2 + "\">" + number2 + "</a><br>";
				something += "<a href=\"" + link3 + "\">" + number3 + "</a><br>";
				$("#search_results").html(something);
				
			}
		})
	})

});

</script>
</head>
<body>
<header>
Utah City Weather Lookup
</header>
<form>
Enter A Utah City: <input type="text" id="cityfield" value=""><br><br>
Suggestion List: <br><span id="txtHint">Currently Empty</span><br><br>
<input id="button" type="submit" value="Submit">
</form>
<p>Selected City:</p>
<textarea id="dispcity">None</textarea>
<p>Current Weather:</p>
<div id="weather">No Weather Data</div>
<hr noshade>
<p>Submit a StackExchange Query!</p>
<textarea id="question">Topic</textarea><br><br>
<input id="button2" type="submit" value="Submit"><br>
<div id="search_results">No Results</div>
</body>
</html>
